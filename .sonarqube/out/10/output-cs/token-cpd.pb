ı
OC:\Users\Alan_Orozco\source\repos\NETMentoringProgram\CatalogClient\App.xaml.cs
	namespace 	
CatalogClient
 
{ 
public		 

partial		 
class		 
App		 
:		 
Application		 *
{

 
public 
static 
IConfiguration $
Config% +
{, -
get. 1
;1 2
private3 :
set; >
;> ?
}@ A
public 
App 
( 
) 
{ 	
Config 
= 
new  
ConfigurationBuilder -
(- .
). /
. 
AddJsonFile 
( 
$str /
)/ 0
. 
Build 
( 
) 
; 
} 	
} 
} Ù
SC:\Users\Alan_Orozco\source\repos\NETMentoringProgram\CatalogClient\AssemblyInfo.cs
[ 
assembly 	
:	 

	ThemeInfo 
( &
ResourceDictionaryLocation 
. 
None #
,# $&
ResourceDictionaryLocation 
. 
SourceAssembly -
)

 
]

 „û
VC:\Users\Alan_Orozco\source\repos\NETMentoringProgram\CatalogClient\MainWindow.xaml.cs
	namespace 	
CatalogClient
 
{ 
public 

partial 
class 

MainWindow #
:$ %
Window& ,
{ 
private 
static 
readonly 
string  &
AadInstance' 2
=3 4
App5 8
.8 9
Config9 ?
[? @
$str@ Q
]Q R
;R S
private 
static 
readonly 
string  &
Tenant' -
=. /
App0 3
.3 4
Config4 :
[: ;
$str; G
]G H
;H I
private 
static 
readonly 
string  &
ClientId' /
=0 1
App2 5
.5 6
Config6 <
[< =
$str= K
]K L
;L M
private 
static 
readonly 
string  &
	Authority' 0
=1 2
string3 9
.9 :
Format: @
(@ A
CultureInfoA L
.L M
InvariantCultureM ]
,] ^
AadInstance_ j
,j k
Tenantl r
)r s
;s t
private 
static 
readonly 
string  &
CatalogScope' 3
=4 5
App6 9
.9 :
Config: @
[@ A
$strA S
]S T
;T U
private 
static 
readonly 
string  &
CatalogBaseAddress' 9
=: ;
App< ?
.? @
Config@ F
[F G
$strG _
]_ `
;` a
private 
readonly 

HttpClient #
_httpClient$ /
=0 1
new2 5

HttpClient6 @
(@ A
)A B
;B C
private 
readonly $
IPublicClientApplication 1
_app2 6
;6 7
private!! 
static!! 
readonly!! 
string!!  &
[!!& '
]!!' (
Scopes!!) /
=!!0 1
{!!2 3
CatalogScope!!4 @
}!!A B
;!!B C
private"" 
static"" 
string"" 
CatalogApiAddress"" /
{## 	
get$$ 
{%% 
string&& 
baseAddress&& "
=&&# $
CatalogBaseAddress&&% 7
;&&7 8
return'' 
baseAddress'' "
.''" #
EndsWith''# +
(''+ ,
$str'', /
)''/ 0
?''1 2
CatalogBaseAddress''3 E
+''F G
$str''H O
:((1 2
CatalogBaseAddress((3 E
+((F G
$str((H P
;((P Q
})) 
}** 	
public,, 

MainWindow,, 
(,, 
),, 
{-- 	
InitializeComponent.. 
(..  
)..  !
;..! "
UserName// 
.// 
Content// 
=// 
$str// 5
;//5 6
_app00 
=00 *
PublicClientApplicationBuilder00 1
.001 2
Create002 8
(008 9
ClientId009 A
)00A B
.11 
WithAuthority11 
(11 
	Authority11 (
)11( )
.22 "
WithDefaultRedirectUri22 '
(22' (
)22( )
.33 
Build33 
(33 
)33 
;33 
	LoadItems44 
(44 
)44 
;44 
}55 	
private77 
void77 
	LoadItems77 
(77 
)77  
{88 	
LoadItemsAsync99 
(99 
)99 
.99 
ConfigureAwait99 +
(99+ ,
false99, 1
)991 2
;992 3
}:: 	
private<< 
async<< 
Task<< 
LoadItemsAsync<< )
(<<) *
int<<* -

categoryId<<. 8
=<<9 :
$num<<; <
)<<< =
{== 	
var>> 
baseUri>> 
=>> 
new>> 

UriBuilder>> (
(>>( )
CatalogApiAddress>>) :
)>>: ;
;>>; <
baseUri?? 
.?? 
Query?? 
=?? 
$str?? 9
+??: ;

categoryId??< F
;??F G
var@@ 
response@@ 
=@@ 
await@@  
_httpClient@@! ,
.@@, -
GetAsync@@- 5
(@@5 6
baseUri@@6 =
.@@= >
Uri@@> A
)@@A B
;@@B C
ifAA 
(AA 
responseAA 
.AA 
IsSuccessStatusCodeAA ,
)AA, -
{BB 
varCC 
itemTxtCC 
=CC 
awaitCC #
responseCC$ ,
.CC, -
ContentCC- 4
.CC4 5
ReadAsStringAsyncCC5 F
(CCF G
)CCG H
;CCH I
varDD 
itemsDD 
=DD 
JsonSerializerDD *
.DD* +
DeserializeDD+ 6
<DD6 7
ListDD7 ;
<DD; <
ItemDD< @
>DD@ A
>DDA B
(DDB C
itemTxtDDC J
,DDJ K
newDDL O!
JsonSerializerOptionsDDP e
{DDf g(
PropertyNameCaseInsensitive	DDh É
=
DDÑ Ö
true
DDÜ ä
}
DDã å
)
DDå ç
;
DDç é

DispatcherEE 
.EE 
InvokeEE !
(EE! "
(EE" #
)EE# $
=>EE% '
{FF 
	ItemsListGG 
.GG 
ItemsSourceGG )
=GG* +
itemsGG, 1
.GG1 2
ToListGG2 8
(GG8 9
)GG9 :
;GG: ;
}HH 
)HH 
;HH 
}II 
elseJJ 
{KK 

MessageBoxLL 
.LL 
ShowLL 
(LL  
responseLL  (
.LL( )
ReasonPhraseLL) 5
)LL5 6
;LL6 7
}MM 
}NN 	
privatePP 
asyncPP 
voidPP "
CreateItemButton_ClickPP 1
(PP1 2
objectPP2 8
senderPP9 ?
,PP? @
RoutedEventArgsPPA P
ePPQ R
)PPR S
{QQ 	
varRR 
accountsRR 
=RR 
(RR 
awaitRR !
_appRR" &
.RR& '
GetAccountsAsyncRR' 7
(RR7 8
)RR8 9
)RR9 :
.RR: ;
ToListRR; A
(RRA B
)RRB C
;RRC D
ifTT 
(TT 
!TT 
accountsTT 
.TT 
AnyTT 
(TT 
)TT 
)TT  
{UU 

MessageBoxVV 
.VV 
ShowVV 
(VV  
$strVV  6
)VV6 7
;VV7 8
returnWW 
;WW 
}XX 
ifYY 
(YY 
stringYY 
.YY 
IsNullOrEmptyYY $
(YY$ %
ItemNameYY% -
.YY- .
TextYY. 2
)YY2 3
||YY4 6
stringYY7 =
.YY= >
IsNullOrEmptyYY> K
(YYK L
ItemDescriptionYYL [
.YY[ \
TextYY\ `
)YY` a
||YYb d
stringZZ 
.ZZ 
IsNullOrEmptyZZ $
(ZZ$ %

ItemAmountZZ% /
.ZZ/ 0
TextZZ0 4
)ZZ4 5
||ZZ6 8
stringZZ9 ?
.ZZ? @
IsNullOrEmptyZZ@ M
(ZZM N
	ItemPriceZZN W
.ZZW X
TextZZX \
)ZZ\ ]
||ZZ^ `
string[[ 
.[[ 
IsNullOrEmpty[[ $
([[$ %
ItemCategoryId[[% 3
.[[3 4
Text[[4 8
)[[8 9
)[[9 :
{\\ 

MessageBox]] 
.]] 
Show]] 
(]]  
$str]]  /
)]]/ 0
;]]0 1
return^^ 
;^^ 
}__  
AuthenticationResultbb  
resultbb! '
=bb( )
nullbb* .
;bb. /
trycc 
{dd 
resultee 
=ee 
awaitee 
_appee #
.ee# $
AcquireTokenSilentee$ 6
(ee6 7
Scopesee7 =
,ee= >
accountsee? G
.eeG H
FirstOrDefaulteeH V
(eeV W
)eeW X
)eeX Y
.ff 
ExecuteAsyncff !
(ff! "
)ff" #
;ff# $

Dispatchergg 
.gg 
Invokegg !
(gg! "
(gg" #
)gg# $
=>gg% '
{hh 
UserNameii 
.ii 
Contentii $
=ii% &
resultii' -
.ii- .
Accountii. 5
.ii5 6
Usernameii6 >
;ii> ?
}jj 
)jj 
;jj 
}kk 
catchmm 
(mm #
MsalUiRequiredExceptionmm *
)mm* +
{nn 

MessageBoxoo 
.oo 
Showoo 
(oo  
$stroo  0
)oo0 1
;oo1 2
SignInButtonpp 
.pp 
	IsEnabledpp &
=pp' (
truepp) -
;pp- .
}qq 
catchrr 
(rr 
MsalExceptionrr  
exrr! #
)rr# $
{ss 
stringuu 
messageuu 
=uu  
exuu! #
.uu# $
Messageuu$ +
;uu+ ,
ifvv 
(vv 
exvv 
.vv 
InnerExceptionvv %
!=vv& (
nullvv) -
)vv- .
{ww 
messagexx 
+=xx 
$strxx -
+xx. /
exxx0 2
.xx2 3
	ErrorCodexx3 <
+xx= >
$strxx? S
+xxT U
exxxV X
.xxX Y
InnerExceptionxxY g
.xxg h
Messagexxh o
;xxo p
}yy 

Dispatcher{{ 
.{{ 
Invoke{{ !
({{! "
({{" #
){{# $
=>{{% '
{|| 
UserName}} 
.}} 
Content}} $
=}}% &
$str}}' )
;}}) *
SignInButton~~  
.~~  !
	IsEnabled~~! *
=~~+ ,
true~~- 1
;~~1 2

MessageBox 
. 
Show #
(# $
$str$ 8
+9 :
message; B
)B C
;C D
}
ÄÄ 
)
ÄÄ 
;
ÄÄ 
return
ÉÉ 
;
ÉÉ 
}
ÑÑ 
_httpClient
àà 
.
àà #
DefaultRequestHeaders
àà -
.
àà- .
Authorization
àà. ;
=
àà< =
new
àà> A'
AuthenticationHeaderValue
ààB [
(
àà[ \
$str
àà\ d
,
ààd e
result
ààf l
.
ààl m
AccessToken
ààm x
)
ààx y
;
àày z
var
ãã 
	itemToAdd
ãã 
=
ãã 
new
ãã 
ItemDTO
ãã  '
(
ãã' (
)
ãã( )
{
åå 
Name
çç 
=
çç 
ItemName
çç 
.
çç  
Text
çç  $
,
çç$ %
Description
éé 
=
éé 
ItemDescription
éé -
.
éé- .
Text
éé. 2
,
éé2 3
Image
èè 
=
èè 
$str
èè 
,
èè 

CategoryId
êê 
=
êê 
int
êê  
.
êê  !
Parse
êê! &
(
êê& '
ItemCategoryId
êê' 5
.
êê5 6
Text
êê6 :
)
êê: ;
,
êê; <
Price
ëë 
=
ëë 
decimal
ëë 
.
ëë  
Parse
ëë  %
(
ëë% &
	ItemPrice
ëë& /
.
ëë/ 0
Text
ëë0 4
)
ëë4 5
,
ëë5 6
Amount
íí 
=
íí 
int
íí 
.
íí 
Parse
íí "
(
íí" #

ItemAmount
íí# -
.
íí- .
Text
íí. 2
)
íí2 3
}
ìì 
;
ìì 
string
îî 
json
îî 
=
îî 
JsonSerializer
îî (
.
îî( )
	Serialize
îî) 2
(
îî2 3
	itemToAdd
îî3 <
)
îî< =
;
îî= >
StringContent
ïï 
content
ïï !
=
ïï" #
new
ïï$ '
StringContent
ïï( 5
(
ïï5 6
json
ïï6 :
,
ïï: ;
Encoding
ïï< D
.
ïïD E
UTF8
ïïE I
,
ïïI J
$str
ïïK ]
)
ïï] ^
;
ïï^ _!
HttpResponseMessage
ôô 
response
ôô  (
=
ôô) *
await
ôô+ 0
_httpClient
ôô1 <
.
ôô< =
	PostAsync
ôô= F
(
ôôF G
CatalogApiAddress
ôôG X
,
ôôX Y
content
ôôZ a
)
ôôa b
;
ôôb c
if
õõ 
(
õõ 
response
õõ 
.
õõ !
IsSuccessStatusCode
õõ ,
)
õõ, -
{
úú 
ItemName
ùù 
.
ùù 
Text
ùù 
=
ùù 
$str
ùù  "
;
ùù" #
ItemDescription
ûû 
.
ûû  
Text
ûû  $
=
ûû% &
$str
ûû' )
;
ûû) *
ItemCategoryId
üü 
.
üü 
Text
üü #
=
üü$ %
$str
üü& (
;
üü( )
	ItemPrice
†† 
.
†† 
Text
†† 
=
††  
$str
††! #
;
††# $

ItemAmount
°° 
.
°° 
Text
°° 
=
°°  !
$str
°°" $
;
°°$ %
await
¢¢ 
LoadItemsAsync
¢¢ $
(
¢¢$ %
	itemToAdd
¢¢% .
.
¢¢. /

CategoryId
¢¢/ 9
)
¢¢9 :
;
¢¢: ;
}
££ 
else
§§ 
{
•• 
if
ßß 
(
ßß 
response
ßß 
.
ßß 

StatusCode
ßß '
==
ßß( *
System
ßß+ 1
.
ßß1 2
Net
ßß2 5
.
ßß5 6
HttpStatusCode
ßß6 D
.
ßßD E
	Forbidden
ßßE N
&&
ßßO Q
response
ßßR Z
.
ßßZ [
Headers
ßß[ b
.
ßßb c
WwwAuthenticate
ßßc r
.
ßßr s
Any
ßßs v
(
ßßv w
)
ßßw x
)
ßßx y
{
®® 

MessageBox
™™ 
.
™™ 
Show
™™ #
(
™™# $
response
™™$ ,
.
™™, -
ReasonPhrase
™™- 9
,
™™9 :
$str
™™; D
)
™™D E
;
™™E F
}
´´ 
else
¨¨ 
{
≠≠ 

MessageBox
ÆÆ 
.
ÆÆ 
Show
ÆÆ #
(
ÆÆ# $
response
ÆÆ$ ,
.
ÆÆ, -
ReasonPhrase
ÆÆ- 9
)
ÆÆ9 :
;
ÆÆ: ;
}
ØØ 
}
∞∞ 
}
≤≤ 	
private
¥¥ 
async
¥¥ 
void
¥¥  
SignInButton_Click
¥¥ -
(
¥¥- .
object
¥¥. 4
sender
¥¥5 ;
,
¥¥; <
RoutedEventArgs
¥¥= L
e
¥¥M N
)
¥¥N O
{
µµ 	
var
∂∂ 
accounts
∂∂ 
=
∂∂ 
(
∂∂ 
await
∂∂ !
_app
∂∂" &
.
∂∂& '
GetAccountsAsync
∂∂' 7
(
∂∂7 8
)
∂∂8 9
)
∂∂9 :
.
∂∂: ;
ToList
∂∂; A
(
∂∂A B
)
∂∂B C
;
∂∂C D
while
∏∏ 
(
∏∏ 
accounts
∏∏ 
.
∏∏ 
Any
∏∏ 
(
∏∏  
)
∏∏  !
)
∏∏! "
{
ππ 
await
∫∫ 
_app
∫∫ 
.
∫∫ 
RemoveAsync
∫∫ &
(
∫∫& '
accounts
∫∫' /
.
∫∫/ 0
First
∫∫0 5
(
∫∫5 6
)
∫∫6 7
)
∫∫7 8
;
∫∫8 9
accounts
ªª 
=
ªª 
(
ªª 
await
ªª !
_app
ªª" &
.
ªª& '
GetAccountsAsync
ªª' 7
(
ªª7 8
)
ªª8 9
)
ªª9 :
.
ªª: ;
ToList
ªª; A
(
ªªA B
)
ªªB C
;
ªªC D
}
ºº 
UserName
ΩΩ 
.
ΩΩ 
Content
ΩΩ 
=
ΩΩ 
$str
ΩΩ !
;
ΩΩ! "
try
¿¿ 
{
¡¡ 
var
¬¬ 
result
¬¬ 
=
¬¬ 
await
¬¬ "
_app
¬¬# '
.
¬¬' ( 
AcquireTokenSilent
¬¬( :
(
¬¬: ;
Scopes
¬¬; A
,
¬¬A B
accounts
¬¬C K
.
¬¬K L
FirstOrDefault
¬¬L Z
(
¬¬Z [
)
¬¬[ \
)
¬¬\ ]
.
√√ 
ExecuteAsync
√√ !
(
√√! "
)
√√" #
;
√√# $

Dispatcher
≈≈ 
.
≈≈ 
Invoke
≈≈ !
(
≈≈! "
(
≈≈" #
)
≈≈# $
=>
≈≈% '
{
∆∆ 
UserName
«« 
.
«« 
Content
«« $
=
««% &
result
««' -
.
««- .
Account
««. 5
.
««5 6
Username
««6 >
;
««> ?
SignInButton
»»  
.
»»  !
	IsEnabled
»»! *
=
»»+ ,
false
»»- 2
;
»»2 3
}
…… 
)
…… 
;
…… 
}
   
catch
ÀÀ 
(
ÀÀ %
MsalUiRequiredException
ÀÀ *
)
ÀÀ* +
{
ÃÃ 
try
ÕÕ 
{
ŒŒ 
var
—— 
result
—— 
=
——  
await
——! &
_app
——' +
.
——+ ,%
AcquireTokenInteractive
——, C
(
——C D
Scopes
——D J
)
——J K
.
““ 
WithAccount
““ $
(
““$ %
accounts
““% -
.
““- .
FirstOrDefault
““. <
(
““< =
)
““= >
)
““> ?
.
”” 

WithPrompt
”” #
(
””# $
Prompt
””$ *
.
””* +
SelectAccount
””+ 8
)
””8 9
.
‘‘ 
ExecuteAsync
‘‘ %
(
‘‘% &
)
‘‘& '
.
’’ 
ConfigureAwait
’’ '
(
’’' (
false
’’( -
)
’’- .
;
’’. /

Dispatcher
◊◊ 
.
◊◊ 
Invoke
◊◊ %
(
◊◊% &
(
◊◊& '
)
◊◊' (
=>
◊◊) +
{
ÿÿ 
UserName
ŸŸ  
.
ŸŸ  !
Content
ŸŸ! (
=
ŸŸ) *
result
ŸŸ+ 1
.
ŸŸ1 2
Account
ŸŸ2 9
.
ŸŸ9 :
Username
ŸŸ: B
;
ŸŸB C
SignInButton
⁄⁄ $
.
⁄⁄$ %
	IsEnabled
⁄⁄% .
=
⁄⁄/ 0
false
⁄⁄1 6
;
⁄⁄6 7
}
€€ 
)
€€ 
;
€€ 
}
‹‹ 
catch
›› 
(
›› 
MsalException
›› $
ex
››% '
)
››' (
{
ﬁﬁ 
if
ﬂﬂ 
(
ﬂﬂ 
ex
ﬂﬂ 
.
ﬂﬂ 
	ErrorCode
ﬂﬂ $
==
ﬂﬂ% '
$str
ﬂﬂ( 7
)
ﬂﬂ7 8
{
‡‡ 
}
‚‚ 
else
„„ 
{
‰‰ 
string
ÊÊ 
message
ÊÊ &
=
ÊÊ' (
ex
ÊÊ) +
.
ÊÊ+ ,
Message
ÊÊ, 3
;
ÊÊ3 4
if
ÁÁ 
(
ÁÁ 
ex
ÁÁ 
.
ÁÁ 
InnerException
ÁÁ -
!=
ÁÁ. 0
null
ÁÁ1 5
)
ÁÁ5 6
{
ËË 
message
ÈÈ #
+=
ÈÈ$ &
$str
ÈÈ' 5
+
ÈÈ6 7
ex
ÈÈ8 :
.
ÈÈ: ;
	ErrorCode
ÈÈ; D
+
ÈÈE F
$str
ÈÈG [
+
ÈÈ\ ]
ex
ÈÈ^ `
.
ÈÈ` a
InnerException
ÈÈa o
.
ÈÈo p
Message
ÈÈp w
;
ÈÈw x
}
ÍÍ 

MessageBox
ÏÏ "
.
ÏÏ" #
Show
ÏÏ# '
(
ÏÏ' (
message
ÏÏ( /
)
ÏÏ/ 0
;
ÏÏ0 1
}
ÌÌ 

Dispatcher
ÔÔ 
.
ÔÔ 
Invoke
ÔÔ %
(
ÔÔ% &
(
ÔÔ& '
)
ÔÔ' (
=>
ÔÔ) +
{
 
UserName
ÒÒ  
.
ÒÒ  !
Content
ÒÒ! (
=
ÒÒ) *
$str
ÒÒ+ -
;
ÒÒ- .
SignInButton
ÚÚ $
.
ÚÚ$ %
	IsEnabled
ÚÚ% .
=
ÚÚ/ 0
true
ÚÚ1 5
;
ÚÚ5 6
}
ÛÛ 
)
ÛÛ 
;
ÛÛ 
}
ÙÙ 
}
ıı 
}
ˆˆ 	
}
˜˜ 
}¯¯ 